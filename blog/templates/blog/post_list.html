{% extends "blog/base.html" %}
{% block title %}
  {% if query %}
    '{{ query }}' 검색 결과
  {% elif category %}
    {{ category.name }}
  {% else %}
    글 목록
  {% endif %}
  - StudyLog
{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h1 class="h3 mb-0">
    {% if query %}
      '{{ query }}' 검색 결과 <span class="text-muted fs-5">({{ posts.count }}개)</span>
    {% elif category %}
      {{ category.name }}
    {% else %}
      글 목록
    {% endif %}
  </h1>
  <a href="{% url 'post_create' %}" class="btn btn-primary">
    <i class="bi bi-plus-circle"></i> 새 글 작성
  </a>
</div>

{% for post in posts %}
  <div class="card mb-3 border hover-lift">
    <!-- ✅ 카드 내부를 flex-column으로 -->
    <div class="card-body d-flex flex-column">
      <h2 class="h5 mb-1">
        <a class="text-decoration-none" href="{% url 'post_detail' post.pk %}">
          {{ post.title }}
        </a>
      </h2>

      <p class="text-muted small mb-2">{{ post.created_at|date:"Y-m-d H:i" }}</p>

      <!-- ✅ 본문은 짧게(3줄 제한) -->
      <p class="text-secondary mb-3 text-truncate-3 break-anywhere">
        {{ post.content|truncatewords:60 }}
      </p>

      <!-- ✅ 항상 오른쪽 아래로 붙게 -->
      <a class="btn btn-outline-secondary btn-sm mt-auto align-self-end"
         href="{% url 'post_detail' post.pk %}">
        더보기 →
      </a>
    </div>
  </div>
{% empty %}
  <div class="alert alert-info">
    {% if query %}
      검색 결과가 없습니다.
    {% else %}
      아직 글이 없어요.
    {% endif %}
  </div>
{% endfor %}
{% endblock %}
